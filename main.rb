#!/usr/bin/ruby -w

require "./toPPN"
require "./solveRPN"

puts "██╗    ██╗███████╗██╗      ██████╗ ██████╗ ███╗   ███╗███████╗    ████████╗ ██████╗           
██║    ██║██╔════╝██║     ██╔════╝██╔═══██╗████╗ ████║██╔════╝    ╚══██╔══╝██╔═══██╗          
██║ █╗ ██║█████╗  ██║     ██║     ██║   ██║██╔████╔██║█████╗         ██║   ██║   ██║          
██║███╗██║██╔══╝  ██║     ██║     ██║   ██║██║╚██╔╝██║██╔══╝         ██║   ██║   ██║          
╚███╔███╔╝███████╗███████╗╚██████╗╚██████╔╝██║ ╚═╝ ██║███████╗       ██║   ╚██████╔╝          
 ╚══╝╚══╝ ╚══════╝╚══════╝ ╚═════╝ ╚═════╝ ╚═╝     ╚═╝╚══════╝       ╚═╝    ╚═════╝           
																							  
███████╗██╗  ██╗██████╗ ███████╗██████╗ ████████╗    ███████╗██╗   ██╗███████╗████████╗███████╗███╗   ███╗
██╔════╝╚██╗██╔╝██╔══██╗██╔════╝██╔══██╗╚══██╔══╝    ██╔════╝╚██╗ ██╔╝██╔════╝╚══██╔══╝██╔════╝████╗ ████║
█████╗   ╚███╔╝ ██████╔╝█████╗  ██████╔╝   ██║       ███████╗ ╚████╔╝ ███████╗   ██║   █████╗  ██╔████╔██║
██╔══╝   ██╔██╗ ██╔═══╝ ██╔══╝  ██╔══██╗   ██║       ╚════██║  ╚██╔╝  ╚════██║   ██║   ██╔══╝  ██║╚██╔╝██║
███████╗██╔╝ ██╗██║     ███████╗██║  ██║   ██║       ███████║   ██║   ███████║   ██║   ███████╗██║ ╚═╝ ██║
╚══════╝╚═╝  ╚═╝╚═╝     ╚══════╝╚═╝  ╚═╝   ╚═╝       ╚══════╝   ╚═╝   ╚══════╝   ╚═╝   ╚══════╝╚═╝     ╚═╝"
print "\n\nEnter file name: "
name = gets.strip!
puts "Processing..."
file = IO.readlines(name)
puts name
vars = Array.new(26, 0)
change = 0
qries = []
stmt = []
file.each do |str|
	str.strip!
	if str[0] === '#'
		str = ""
	elsif str[0] === '='
		i = 1
		while str[i]
			vars[str[i].ord - 'a'.ord] = 1
			i+=1
		end
	else
		if (str[0] === '?')
			i = 1
			while str[i]
				qries.push(str[i].ord - 'a'.ord)
				i+=1
			end
		elsif str != ""
			stmt.push(str)
		end
	end
end
rule = Struct.new(:input_e, :out_e)
rules = []
stmt.each do |rle|
	arr = rle.split("=>")
	rpn = RPNExpression.from_infix arr[0]
	puts rpn
	my_res = solveRPN(rpn, vars)
	puts my_res
end